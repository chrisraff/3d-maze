<!DOCTYPE html>
<html lang="en">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no">
        <meta name="description" content="Fully three dimensional mazes, in first person"/>

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-title" content="3D Maze">
        <link rel="apple-touch-icon" href="icons/icon-152x152.png">

        <meta name="theme-color" content="#dddddd">

        <meta property="og:title" content="3D Maze | Chris Raff" />
        <meta property="og:description" content="Fully three dimensional mazes, in first person" />
        <meta property="og:url" content="https://www.chrisraff.com/3d-maze" />
        <meta property="og:image" content="https://www.chrisraff.com/3d-maze/screenshot.png" />
        <meta property="og:image:type" content="image/png" />
        <meta property="og:image:width" content="1057" />
        <meta property="og:image:height" content="835" />

        <link rel="manifest" href="manifest.json">

        <title>3D Maze | Chris Raff</title>

        <style>
            body { margin: 0; }
            canvas { display: block; }

            #overlay {
                position: absolute;
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;

                overflow: hidden;

                pointer-events: none;
            }
            #overlay > * {
                pointer-events: initial;
            }

            #blocker {
                flex: 1 0 0;

                overflow-y: auto;
                background-color: rgba(0,0,0,0.5);

                display: flex;
                justify-content: center;
                flex-direction: column;
            }

            #menu-body {
                -webkit-text-size-adjust: none;

                color: #ffffff;
                text-align: center;
                font-family: Arial;
                font-size: 12pt;
                line-height: 24px;

                cursor: pointer;
            }

            #menu-new-maze {
                font-size: 150%;
                width: fit-content;
                margin: auto;
                padding: 1em;
            }
            body.formfactor-non-desktop #menu-new-maze {
                font-size: 110%;
            }
            #menu-new-maze button {
                padding: 0.5em;
            }
            body:not(.formfactor-non-desktop) #menu-new-maze button {
                font-size: 150%;
            }
            body.formfactor-non-desktop #menu-new-maze button {
                font-size: 120%;
            }
            #menu-new-maze input[type='range'] {
                width: 80%;
                min-width: 20em;
            }

            #completionMessage {
                width: 100%;

                color: #ffffff;
                font-family: Arial;
                font-size: 36px;
                text-align: center;
                padding: 10px;

                border-bottom: 1px solid #3336;

                background-color: rgba(0,0,0,0.25);
            }

            #compass {
                position: absolute;
                top: env(safe-area-inset-top);
                left: env(safe-area-inset-left);
            }

            #options-corner {
                position: absolute;
                top: env(safe-area-inset-top);
                right: env(safe-area-inset-right);
                padding: 10px;

                color: #ffffff;
                font-family: Arial;
                line-height: 36px;
            }

            #options-body {
                border: 1px solid rgba(128, 128, 128, 0.5);
                background-color: rgba(0,0,0,0.25);
                padding: 1em;
            }

            #version {
                position: absolute;
                bottom: env(safe-area-inset-bottom);
                right: env(safe-area-inset-right);
                padding: 10px;

                color: rgba(255,255,255,0.25);
                font-family: Arial;
                font-size: 10px;
            }

            #copyright {
                position: absolute;
                bottom: env(safe-area-inset-bottom);
                left: 0;
                right: 0;
                margin-left: auto;
                margin-right: auto;

                color: rgba(255,255,255,0.25);
                font-family: Arial;
                font-size: 10px;
                padding: 10px;
                text-align: center;
            }

            .hide {
                display: none !important;
            }

            .frosted {
                backdrop-filter: blur(0.3em);
            }

            .transparent-text-50 {
                color:rgba(255,255,255,0.5);
            }

            body.formfactor-non-desktop .formfactor-desktop {
                display: none;
            }
            body:not(.formfactor-non-desktop) .formfactor-non-desktop {
                display: none;
            }
        </style>

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120805992-1"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-120805992-1');
        </script>

    </head>
    <body>
        <script type="text/javascript" src="js/detectmobilebrowser.js"></script>
        <script type="text/javascript">
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('./service-worker.js')
                        .then((reg) => {
                            console.log('service worker registered', reg);
                        });
                });
            }
        </script>

        <div id="overlay">
            <div id="completionMessage" class="frosted hide">
                Maze Completed!<br/>
                <span styel="font-size:18px">Time: <span id="mazeTimeSpan"></span>, Size: <span id="mazeCompSizeSpan"></span></span><br/>
                <span style="font-size:14px" class="formfactor-desktop">Press escape to start a new maze</span>
                <span style="font-size:14px;" class="formfactor-non-desktop">Tap here to start a new maze</span>
            </div>

            <div id="blocker">
                <div id="menu-body" class="blocker-tab">
                    <br/>
                    <span style="font-size:56px">3D Maze</span> <br/>
                    <a href="https://www.chrisraff.com" class="transparent-text-50">ChrisRaff.com</a>

                    <div id="menu-intro">
                        <br/><br /><br class="formfactor-desktop"/>
                        <span style="font-size:36px" class="formfactor-desktop">Click to play</span>
                        <span style="font-size:36px;" class="formfactor-non-desktop">Tap to play</span>
                        <br /><br class="formfactor-desktop"/>
                        <span class="formfactor-desktop">
                            Move: WASD, space and shift<br/>
                            Look: MOUSE, Q and E to roll<br/>
                            Find the exit of the maze. The compass (top left) points towards the exit, and the colors are brighter there.<br/>
                            <br/>
                            Try adding this game to your phone's home screen!
                        </span>
                        <span class="formfactor-non-desktop">
                            Move: Left side of screen<br/>
                            Look: Right side of screen<br/>
                            Find the exit of the maze. The compass (top left) points towards the exit.<br/>
                            Tap the compass to return to the menu.
                        </span>
                    </div>

                    <div id="menu-new-maze" class="hide" onclick="event.stopPropagation();">
                        <br class="formfactor-desktop"/>
                        <button id='menu-new-maze-button'>Start New Maze</button>
                        <br class="formfactor-desktop"/>
                        <br/>
                        <input type="range" min="2" max="12" value="3" class="slider" id="menu-new-maze-size-slider" oninput="document.querySelector('#menu-new-maze-size-span').innerHTML = this.value">
                        <br class="formfactor-desktop"/>
                        <br/>
                        <span style="font-size: 150%">Size: <span id="menu-new-maze-size-span">3</span></span>
                        <br class="formfactor-non-desktop"/>
                    </div>

                    <div id="menu-pause" class="hide">
                        <br/>
                        <span class="formfactor-desktop">Click anywhere to continue</span>
                        <span class="formfactor-non-desktop">Tap anywhere to continue</span>
                        <br/>
                        <span class="transparent-text-50" style="font-size: 75%;">Use "Options" to start a new maze</span>
                    </div>

                    <br class="formfactor-non-desktop"/>
                </div>

                <div id="options-corner" onclick="event.stopPropagation();">
                    <div >
                        <button style="width: 100%" onclick="document.querySelector('#options-body').classList.toggle('hide')">Options</button>
                    </div>

                    <div id="options-body" class="hide">
                        New Size: <span id="newMazeSizeSpan">3</span> <br/>
                        <input type="range" min="2" max="12" value="3" class="slider" id="newMazeSizeSlider" oninput="document.querySelector('#newMazeSizeSpan').innerHTML = this.value">
                        <br/>
                        <span style="font-size: 150%">Size: <span id="mazeSizeSpan">3</span></span> <br/>
                        <button id='mazeBuildButton'>Build New Maze</button>

                        <br/>

                        <input type="checkbox" id="setting-fixed-camera" name="setting-fixed-camera" checked />
                        <label for="setting-fixed-camera">Fixed Camera</label>
                    </div>
                </div>

                <div id="copyright">
                    © Chris Raff 2020 - 2023
                </div>

                <div id="version">
                    Version 0.0.11
                </div>
            </div>
        </div>

        <script type="module" src="js/maze.js"></script>
        <script type="module" src="js/game.js"></script>
    </body>
</html>
